import numpy, csv, time
from scikits.learn.datasets.misc import dumpvar


f = open('01423000.dly', 'r')
reader = csv.reader(f)
reader.dialect.delimiter='\t'

n_comments = 28
for i in range(n_comments):
	reader.next()

LABELS = ['agency', 'station', 'date', 'discharge', 'code']

table = numpy.array([a for a in reader])

AGENCY, STATION, DATE, DISCHARGE, CODE = table.transpose()

# Write the data in nwis.py
a = open("../nwis.py", "w")
a.write('# Autogenerated by convert.py at %s\n\n' % 
        time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime()))

for i in range(2,5):
	a.writelines(dumpvar(list(table[:,i]), LABELS[i]))
a.close()
